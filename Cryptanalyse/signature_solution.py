#!/bin/python3
from pwn import *
import json
from hashlib import md5 as hash

def convol_hash(data: bytes, power: int):
    acc = data
    for _ in range(power):
        acc = hash(acc).digest()
    return acc

conn = remote('challenges.404ctf.fr',30724)
data = conn.recvline()
sig = json.loads(data)["sig"]

tmp="010100110100000101001100010101010101010000100000010000110100000100100000010101100100000100111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001011110"
obj="011001110110100101101101011011010110010100100000011001100110110001100001011001110111101001011111011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010000000000000000000000000000000000000000000000000000000010111111"
for l in range(0, 256+8, 4):
	sig[l//4] = convol_hash(bytes.fromhex(sig[l//4]), int(obj[l:l+4], 2) - int(tmp[l:l+4], 2)).hex()

output = {}
output["msg"] = b'gimme flagz_aaaaaaaaaaaaa'.hex()
output["sig"] = sig

conn.sendline(json.dumps(output))
conn.interactive()

